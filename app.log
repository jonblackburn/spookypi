2024-10-18 17:19:08,854 - main - INFO - Initailizing SpookyPi...
2024-10-18 17:19:08,854 - main - INFO - Creating the manual log directory...
2024-10-18 17:19:08,854 - main - INFO - Creating the captures directory...
2024-10-18 17:19:08,854 - main - INFO - Initializing services...
2024-10-18 17:19:09,388 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2024-10-18 17:19:09,388 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2024-10-18 17:19:09,390 - werkzeug - INFO -  * Restarting with stat
2024-10-18 17:19:13,203 - main - INFO - Initailizing SpookyPi...
2024-10-18 17:19:13,204 - main - INFO - Creating the manual log directory...
2024-10-18 17:19:13,204 - main - INFO - Creating the captures directory...
2024-10-18 17:19:13,204 - main - INFO - Initializing services...
2024-10-18 17:19:13,776 - werkzeug - WARNING -  * Debugger is active!
2024-10-18 17:19:13,779 - werkzeug - INFO -  * Debugger PIN: 509-638-917
2024-10-18 17:19:20,444 - werkzeug - INFO - 127.0.0.1 - - [18/Oct/2024 17:19:20] "GET / HTTP/1.1" 200 -
2024-10-18 17:19:22,870 - werkzeug - INFO - 127.0.0.1 - - [18/Oct/2024 17:19:22] "[32mPOST /start HTTP/1.1[0m" 302 -
2024-10-18 17:19:22,872 - werkzeug - INFO - 127.0.0.1 - - [18/Oct/2024 17:19:22] "GET / HTTP/1.1" 200 -
2024-10-18 17:19:26,840 - main - INFO - New object detected.
2024-10-18 17:19:26,850 - main - INFO - 2024-10-18_17-19-26 - Detected: person, Image: person_2024-10-18_17-19-26_0.jpg, Confidence: 1.00, ID: 0
2024-10-18 17:19:26,850 - OpenAIService - INFO - Using existing assistant
2024-10-18 17:19:46,680 - VoiceService - INFO - Listening for user response at 1729286386.6804965...
2024-10-18 17:19:51,700 - VoiceService - INFO - User response captured at 1729286391.7006433 - recording time: 5.02014684677124
2024-10-18 17:19:52,789 - VoiceService - INFO - User response: Thank you for watching!

2024-10-18 17:19:52,790 - VoiceService - INFO - Transciption Metrics: 1.089390516281128 - total time: 6.109537363052368
2024-10-18 17:19:52,791 - main - INFO - User response: Thank you for watching!

2024-10-18 17:19:52,792 - OpenAIService - INFO - Using existing assistant
2024-10-18 17:20:06,457 - werkzeug - INFO - 127.0.0.1 - - [18/Oct/2024 17:20:06] "[32mPOST /stop HTTP/1.1[0m" 302 -
2024-10-18 17:20:06,457 - werkzeug - INFO - 127.0.0.1 - - [18/Oct/2024 17:20:06] "[32mPOST /stop HTTP/1.1[0m" 302 -
2024-10-18 17:20:06,457 - werkzeug - INFO - 127.0.0.1 - - [18/Oct/2024 17:20:06] "[32mPOST /stop HTTP/1.1[0m" 302 -
2024-10-18 17:20:06,461 - werkzeug - INFO - 127.0.0.1 - - [18/Oct/2024 17:20:06] "GET / HTTP/1.1" 200 -
2024-10-18 17:29:28,081 - main - INFO - Initailizing SpookyPi...
2024-10-18 17:29:28,082 - main - INFO - Creating the manual log directory...
2024-10-18 17:29:28,082 - main - INFO - Creating the captures directory...
2024-10-18 17:29:28,082 - main - INFO - Initializing services...
2024-10-18 17:29:28,570 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:80
 * Running on http://192.168.4.248:80
2024-10-18 17:29:28,570 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2024-10-18 17:29:28,571 - werkzeug - INFO -  * Restarting with stat
2024-10-18 17:29:31,931 - main - INFO - Initailizing SpookyPi...
2024-10-18 17:29:31,931 - main - INFO - Creating the manual log directory...
2024-10-18 17:29:31,932 - main - INFO - Creating the captures directory...
2024-10-18 17:29:31,932 - main - INFO - Initializing services...
2024-10-18 17:29:32,474 - werkzeug - WARNING -  * Debugger is active!
2024-10-18 17:29:32,477 - werkzeug - INFO -  * Debugger PIN: 509-638-917
2024-10-18 17:29:48,994 - werkzeug - INFO - 192.168.5.2 - - [18/Oct/2024 17:29:48] "GET / HTTP/1.1" 200 -
2024-10-18 17:29:49,409 - werkzeug - INFO - 192.168.5.2 - - [18/Oct/2024 17:29:49] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2024-10-18 17:31:08,636 - werkzeug - INFO -  * Detected change in 'D:\\Repos\\jonblackburn\\spooky-season\\spookypi\\host.py', reloading
2024-10-18 17:31:09,249 - werkzeug - INFO -  * Restarting with stat
2024-10-18 17:31:12,526 - main - INFO - Initailizing SpookyPi...
2024-10-18 17:31:12,527 - main - INFO - Creating the manual log directory...
2024-10-18 17:31:12,527 - main - INFO - Creating the captures directory...
2024-10-18 17:31:12,527 - main - INFO - Initializing services...
2024-10-18 17:31:13,059 - werkzeug - WARNING -  * Debugger is active!
2024-10-18 17:31:13,061 - werkzeug - INFO -  * Debugger PIN: 509-638-917
2024-10-18 17:31:18,393 - werkzeug - INFO - 192.168.5.2 - - [18/Oct/2024 17:31:18] "GET / HTTP/1.1" 200 -
2024-10-18 17:32:13,213 - werkzeug - INFO -  * Detected change in 'D:\\Repos\\jonblackburn\\spooky-season\\spookypi\\app\\ai_services\\voice_service.py', reloading
2024-10-18 17:32:13,809 - werkzeug - INFO -  * Restarting with stat
2024-10-18 17:32:16,874 - main - INFO - Initailizing SpookyPi...
2024-10-18 17:32:16,874 - main - INFO - Creating the manual log directory...
2024-10-18 17:32:16,875 - main - INFO - Creating the captures directory...
2024-10-18 17:32:16,875 - main - INFO - Initializing services...
2024-10-18 17:32:17,410 - werkzeug - WARNING -  * Debugger is active!
2024-10-18 17:32:17,413 - werkzeug - INFO -  * Debugger PIN: 509-638-917
2024-10-18 17:32:19,745 - werkzeug - INFO -  * Detected change in 'D:\\Repos\\jonblackburn\\spooky-season\\spookypi\\app\\ai_services\\voice_service.py', reloading
2024-10-18 17:32:20,470 - werkzeug - INFO -  * Restarting with stat
2024-10-18 17:49:11,181 - main - INFO - Initailizing SpookyPi...
2024-10-18 17:49:11,181 - main - INFO - Creating the manual log directory...
2024-10-18 17:49:11,181 - main - INFO - Creating the captures directory...
2024-10-18 17:49:11,182 - main - INFO - Initializing services...
2024-10-18 17:49:11,707 - VoiceService - ERROR - Failed to play audio from file: `pip install ipython` required when `notebook=False` 
Traceback (most recent call last):
  File "D:\Repos\jonblackburn\spooky-season\spookypi\venv-spookypi\Lib\site-packages\elevenlabs\play.py", line 22, in play
    from IPython.display import Audio, display  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ModuleNotFoundError: No module named 'IPython'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Repos\jonblackburn\spooky-season\spookypi\app\ai_services\voice_service.py", line 105, in play_audio_from_file
    play(data, samplerate)
  File "D:\Repos\jonblackburn\spooky-season\spookypi\venv-spookypi\Lib\site-packages\elevenlabs\play.py", line 27, in play
    raise ValueError(message)
ValueError: `pip install ipython` required when `notebook=False` 
2024-10-18 17:49:11,723 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:80
 * Running on http://192.168.4.248:80
2024-10-18 17:49:11,723 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2024-10-18 17:49:11,724 - werkzeug - INFO -  * Restarting with stat
2024-10-18 17:49:14,659 - main - INFO - Initailizing SpookyPi...
2024-10-18 17:49:14,660 - main - INFO - Creating the manual log directory...
2024-10-18 17:49:14,660 - main - INFO - Creating the captures directory...
2024-10-18 17:49:14,660 - main - INFO - Initializing services...
2024-10-18 17:49:15,172 - VoiceService - ERROR - Failed to play audio from file: `pip install ipython` required when `notebook=False` 
Traceback (most recent call last):
  File "D:\Repos\jonblackburn\spooky-season\spookypi\venv-spookypi\Lib\site-packages\elevenlabs\play.py", line 22, in play
    from IPython.display import Audio, display  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ModuleNotFoundError: No module named 'IPython'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Repos\jonblackburn\spooky-season\spookypi\app\ai_services\voice_service.py", line 105, in play_audio_from_file
    play(data, samplerate)
  File "D:\Repos\jonblackburn\spooky-season\spookypi\venv-spookypi\Lib\site-packages\elevenlabs\play.py", line 27, in play
    raise ValueError(message)
ValueError: `pip install ipython` required when `notebook=False` 
2024-10-18 17:49:15,183 - werkzeug - WARNING -  * Debugger is active!
2024-10-18 17:49:15,186 - werkzeug - INFO -  * Debugger PIN: 509-638-917
2024-10-18 17:50:44,788 - werkzeug - INFO -  * Detected change in 'D:\\Repos\\jonblackburn\\spooky-season\\spookypi\\app\\ai_services\\voice_service.py', reloading
2024-10-18 17:50:45,510 - werkzeug - INFO -  * Restarting with stat
2024-10-18 17:51:30,270 - main - INFO - Initailizing SpookyPi...
2024-10-18 17:51:30,271 - main - INFO - Creating the manual log directory...
2024-10-18 17:51:30,271 - main - INFO - Creating the captures directory...
2024-10-18 17:51:30,271 - main - INFO - Initializing services...
2024-10-18 17:51:33,107 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:80
 * Running on http://192.168.4.248:80
2024-10-18 17:51:33,107 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2024-10-18 17:51:33,109 - werkzeug - INFO -  * Restarting with stat
2024-10-18 17:51:36,044 - main - INFO - Initailizing SpookyPi...
2024-10-18 17:51:36,045 - main - INFO - Creating the manual log directory...
2024-10-18 17:51:36,045 - main - INFO - Creating the captures directory...
2024-10-18 17:51:36,045 - main - INFO - Initializing services...
2024-10-18 17:51:38,943 - werkzeug - WARNING -  * Debugger is active!
2024-10-18 17:51:38,945 - werkzeug - INFO -  * Debugger PIN: 509-638-917
2024-10-18 17:52:00,454 - werkzeug - INFO - 192.168.5.2 - - [18/Oct/2024 17:52:00] "GET / HTTP/1.1" 200 -
2024-10-18 17:52:07,855 - werkzeug - INFO - 192.168.5.2 - - [18/Oct/2024 17:52:07] "[32mPOST /start HTTP/1.1[0m" 302 -
2024-10-18 17:52:07,882 - werkzeug - INFO - 192.168.5.2 - - [18/Oct/2024 17:52:07] "GET / HTTP/1.1" 200 -
2024-10-18 17:52:10,958 - main - INFO - New object detected.
2024-10-18 17:52:10,962 - main - INFO - 2024-10-18_17-52-10 - Detected: person, Image: person_2024-10-18_17-52-10_0.jpg, Confidence: 1.00, ID: 0
2024-10-18 17:52:10,963 - OpenAIService - INFO - Using existing assistant
2024-10-18 17:52:31,573 - VoiceService - INFO - Listening for user response at 1729288351.573918...
2024-10-18 17:52:36,613 - VoiceService - INFO - User response captured at 1729288356.6139781 - recording time: 5.040060043334961
2024-10-18 17:52:38,359 - VoiceService - INFO - User response: standing there. Now she's in the shower.

2024-10-18 17:52:38,359 - VoiceService - INFO - Transciption Metrics: 1.7456896305084229 - total time: 6.785749673843384
2024-10-18 17:52:38,361 - main - INFO - User response: standing there. Now she's in the shower.

2024-10-18 17:52:38,361 - OpenAIService - INFO - Using existing assistant
2024-10-18 18:17:31,343 - main - INFO - Initailizing SpookyPi...
2024-10-18 18:17:31,344 - main - INFO - Creating the manual log directory...
2024-10-18 18:17:31,344 - main - INFO - Creating the captures directory...
2024-10-18 18:17:31,344 - main - INFO - Initializing services...
2024-10-18 18:17:31,899 - VoiceService - ERROR - Failed to play audio from file: [Errno -9997] Invalid sample rate
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 107, in play_audio_from_file
    stream = p.open(format=pyaudio.paInt16,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/pyaudio/__init__.py", line 639, in open
    stream = PyAudio.Stream(self, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/pyaudio/__init__.py", line 441, in __init__
    self._stream = pa.open(**arguments)
                   ^^^^^^^^^^^^^^^^^^^^
OSError: [Errno -9997] Invalid sample rate
2024-10-18 18:17:31,911 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:80
 * Running on http://192.168.5.3:80
2024-10-18 18:17:31,912 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2024-10-18 18:17:31,913 - werkzeug - INFO -  * Restarting with stat
2024-10-18 18:17:34,988 - main - INFO - Initailizing SpookyPi...
2024-10-18 18:17:34,989 - main - INFO - Creating the manual log directory...
2024-10-18 18:17:34,989 - main - INFO - Creating the captures directory...
2024-10-18 18:17:34,989 - main - INFO - Initializing services...
2024-10-18 18:17:35,526 - VoiceService - ERROR - Failed to play audio from file: [Errno -9997] Invalid sample rate
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 107, in play_audio_from_file
    stream = p.open(format=pyaudio.paInt16,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/pyaudio/__init__.py", line 639, in open
    stream = PyAudio.Stream(self, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/pyaudio/__init__.py", line 441, in __init__
    self._stream = pa.open(**arguments)
                   ^^^^^^^^^^^^^^^^^^^^
OSError: [Errno -9997] Invalid sample rate
2024-10-18 18:17:35,540 - werkzeug - WARNING -  * Debugger is active!
2024-10-18 18:17:35,540 - werkzeug - INFO -  * Debugger PIN: 454-529-102
2024-10-18 18:18:06,278 - werkzeug - INFO - 192.168.5.2 - - [18/Oct/2024 18:18:06] "GET / HTTP/1.1" 200 -
2024-10-18 18:18:06,708 - werkzeug - INFO - 192.168.5.2 - - [18/Oct/2024 18:18:06] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2024-10-18 18:18:38,920 - werkzeug - INFO - 192.168.5.2 - - [18/Oct/2024 18:18:38] "[32mPOST /start HTTP/1.1[0m" 302 -
2024-10-18 18:18:38,952 - werkzeug - INFO - 192.168.5.2 - - [18/Oct/2024 18:18:38] "GET / HTTP/1.1" 200 -
2024-10-18 18:18:49,254 - main - INFO - New object detected.
2024-10-18 18:18:49,257 - main - INFO - 2024-10-18_18-18-49 - Detected: person, Image: person_2024-10-18_18-18-49_0.jpg, Confidence: 0.96, ID: 0
2024-10-18 18:18:49,257 - OpenAIService - INFO - Using existing assistant
2024-10-18 18:18:57,528 - VoiceService - ERROR - Failed to generate audio: [Errno 32] Broken pipe
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 60, in generate_streaming_audio
    stream(audio_content)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/elevenlabs/play.py", line 91, in stream
    mpv_process.stdin.flush()  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^
BrokenPipeError: [Errno 32] Broken pipe
2024-10-18 18:18:57,551 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:18:57,554 - main - WARNING - Failed to capture user response.
2024-10-18 18:18:57,666 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:18:57,668 - main - WARNING - Failed to capture user response.
2024-10-18 18:18:57,783 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:18:57,784 - main - WARNING - Failed to capture user response.
2024-10-18 18:18:57,895 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:18:57,898 - main - WARNING - Failed to capture user response.
2024-10-18 18:18:58,023 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:18:58,025 - main - WARNING - Failed to capture user response.
2024-10-18 18:18:58,141 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:18:58,145 - main - WARNING - Failed to capture user response.
2024-10-18 18:18:58,255 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:18:58,259 - main - WARNING - Failed to capture user response.
2024-10-18 18:18:58,375 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:18:58,376 - main - WARNING - Failed to capture user response.
2024-10-18 18:18:58,490 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:18:58,492 - main - WARNING - Failed to capture user response.
2024-10-18 18:18:58,607 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:18:58,608 - main - WARNING - Failed to capture user response.
2024-10-18 18:18:58,728 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:18:58,731 - main - WARNING - Failed to capture user response.
2024-10-18 18:18:58,848 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:18:58,851 - main - WARNING - Failed to capture user response.
2024-10-18 18:18:58,963 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:18:58,965 - main - WARNING - Failed to capture user response.
2024-10-18 18:18:59,076 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:18:59,078 - main - WARNING - Failed to capture user response.
2024-10-18 18:18:59,197 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:18:59,214 - main - WARNING - Failed to capture user response.
2024-10-18 18:18:59,343 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:18:59,345 - main - WARNING - Failed to capture user response.
2024-10-18 18:18:59,460 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:18:59,461 - main - WARNING - Failed to capture user response.
2024-10-18 18:18:59,575 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:18:59,578 - main - WARNING - Failed to capture user response.
2024-10-18 18:18:59,697 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:18:59,699 - main - WARNING - Failed to capture user response.
2024-10-18 18:18:59,818 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:18:59,820 - main - WARNING - Failed to capture user response.
2024-10-18 18:18:59,931 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:18:59,933 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:00,050 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:00,054 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:00,170 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:00,171 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:00,289 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:00,291 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:00,408 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:00,410 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:00,527 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:00,529 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:00,639 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:00,643 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:00,759 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:00,761 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:00,871 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:00,873 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:00,989 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:00,991 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:01,110 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:01,112 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:01,219 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:01,221 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:01,335 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:01,338 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:01,456 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:01,458 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:01,568 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:01,570 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:01,690 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:01,691 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:01,798 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:01,800 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:01,916 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:01,918 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:02,027 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:02,028 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:02,131 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:02,135 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:02,256 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:02,257 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:02,374 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:02,379 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:02,491 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:02,494 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:02,607 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:02,610 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:02,725 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:02,727 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:02,837 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:02,839 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:02,962 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:02,964 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:03,075 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:03,079 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:03,190 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:03,192 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:03,306 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:03,307 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:03,422 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:03,423 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:03,535 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:03,539 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:03,659 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:03,661 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:03,776 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:03,777 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:03,897 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:03,899 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:04,011 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:04,012 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:04,125 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:04,130 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:04,267 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:04,268 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:04,398 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:04,400 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:04,512 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:04,514 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:04,635 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:04,638 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:04,750 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:04,752 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:04,870 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:04,872 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:04,992 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:04,993 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:05,104 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:05,107 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:05,213 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:05,215 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:05,332 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:05,335 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:05,458 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:05,460 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:05,574 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:05,575 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:05,692 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:05,695 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:05,814 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:05,817 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:05,927 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:05,929 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:06,040 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:06,042 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:06,155 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:06,157 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:06,270 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:06,271 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:06,388 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:06,390 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:06,503 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:06,505 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:06,619 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:06,622 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:06,735 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:06,738 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:06,856 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:06,857 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:06,971 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:06,973 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:07,088 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:07,090 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:07,200 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:07,202 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:07,318 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:07,320 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:07,440 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:07,442 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:07,564 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:07,567 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:07,686 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:07,688 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:07,810 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:07,812 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:07,926 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:07,928 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:08,043 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:08,045 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:08,160 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:08,162 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:08,271 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:08,273 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:08,387 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:08,390 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:08,517 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:08,519 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:08,640 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:08,643 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:08,759 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:08,762 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:08,883 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:08,885 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:08,999 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:09,002 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:09,110 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:09,112 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:09,243 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:09,255 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:09,369 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:09,371 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:09,502 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:09,504 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:09,625 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:09,627 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:09,743 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:09,745 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:09,863 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:09,865 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:09,975 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:09,979 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:10,090 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:10,091 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:10,203 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:10,204 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:10,325 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:10,327 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:10,448 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:10,450 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:10,570 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:10,572 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:10,687 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:10,689 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:10,795 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:10,797 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:10,908 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:10,911 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:11,025 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:11,027 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:11,136 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:11,138 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:11,251 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:11,253 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:11,359 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:11,360 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:11,464 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:11,466 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:11,584 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:11,587 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:11,695 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:11,697 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:11,804 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:11,805 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:11,917 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:11,918 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:12,032 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:12,033 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:12,150 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:12,152 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:12,264 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:12,267 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:12,387 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:12,388 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:12,498 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:12,500 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:12,620 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:12,621 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:12,727 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:12,728 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:12,837 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:12,839 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:12,954 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:12,955 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:13,067 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:13,068 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:13,184 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:13,185 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:13,300 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:13,302 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:13,414 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:13,416 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:13,533 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:13,535 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:13,648 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:13,651 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:13,760 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:13,763 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:13,875 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:13,877 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:13,988 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:13,990 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:14,107 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:14,111 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:14,243 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:14,250 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:14,371 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:14,373 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:14,487 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:14,489 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:14,613 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:14,615 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:14,730 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:14,731 - main - WARNING - Failed to capture user response.
2024-10-18 18:19:14,844 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 72, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 71, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-18 18:19:14,846 - main - WARNING - Failed to capture user response.
2024-10-19 00:13:10,443 - main - INFO - Initailizing SpookyPi...
2024-10-19 00:13:10,443 - main - INFO - Creating the manual log directory...
2024-10-19 00:13:10,443 - main - INFO - Creating the captures directory...
2024-10-19 00:13:10,444 - main - INFO - Initializing services...
2024-10-19 00:13:10,971 - VoiceService - ERROR - Failed to play audio from file: [Errno -9997] Invalid sample rate
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 107, in play_audio_from_file
    stream = p.open(format=pyaudio.paInt16,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/pyaudio/__init__.py", line 639, in open
    stream = PyAudio.Stream(self, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/pyaudio/__init__.py", line 441, in __init__
    self._stream = pa.open(**arguments)
                   ^^^^^^^^^^^^^^^^^^^^
OSError: [Errno -9997] Invalid sample rate
2024-10-19 00:13:10,985 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:80
 * Running on http://192.168.5.3:80
2024-10-19 00:13:10,986 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2024-10-19 00:13:10,987 - werkzeug - INFO -  * Restarting with stat
2024-10-19 00:13:14,027 - main - INFO - Initailizing SpookyPi...
2024-10-19 00:13:14,027 - main - INFO - Creating the manual log directory...
2024-10-19 00:13:14,027 - main - INFO - Creating the captures directory...
2024-10-19 00:13:14,027 - main - INFO - Initializing services...
2024-10-19 00:13:14,583 - VoiceService - ERROR - Failed to play audio from file: [Errno -9997] Invalid sample rate
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 107, in play_audio_from_file
    stream = p.open(format=pyaudio.paInt16,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/pyaudio/__init__.py", line 639, in open
    stream = PyAudio.Stream(self, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/pyaudio/__init__.py", line 441, in __init__
    self._stream = pa.open(**arguments)
                   ^^^^^^^^^^^^^^^^^^^^
OSError: [Errno -9997] Invalid sample rate
2024-10-19 00:13:14,595 - werkzeug - WARNING -  * Debugger is active!
2024-10-19 00:13:14,596 - werkzeug - INFO -  * Debugger PIN: 454-529-102
2024-10-19 00:13:58,992 - werkzeug - INFO - 192.168.5.2 - - [19/Oct/2024 00:13:58] "GET / HTTP/1.1" 200 -
2024-10-19 00:13:59,215 - werkzeug - INFO - 192.168.5.2 - - [19/Oct/2024 00:13:59] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2024-10-19 00:14:04,543 - werkzeug - INFO - 192.168.5.2 - - [19/Oct/2024 00:14:04] "[32mPOST /start HTTP/1.1[0m" 302 -
2024-10-19 00:14:04,579 - werkzeug - INFO - 192.168.5.2 - - [19/Oct/2024 00:14:04] "GET / HTTP/1.1" 200 -
2024-10-19 00:14:44,514 - main - INFO - New object detected.
2024-10-19 00:14:44,517 - main - INFO - 2024-10-19_00-14-44 - Detected: person, Image: person_2024-10-19_00-14-44_0.jpg, Confidence: 0.98, ID: 0
2024-10-19 00:14:44,518 - OpenAIService - INFO - Using existing assistant
2024-10-19 00:31:35,983 - main - INFO - Initailizing SpookyPi...
2024-10-19 00:31:35,984 - main - INFO - Creating the manual log directory...
2024-10-19 00:31:35,984 - main - INFO - Creating the captures directory...
2024-10-19 00:31:35,984 - main - INFO - Initializing services...
2024-10-19 00:31:36,505 - VoiceService - ERROR - Failed to play audio from file: [Errno -9997] Invalid sample rate
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 107, in play_audio_from_file
    stream = p.open(format=pyaudio.paInt16,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/pyaudio/__init__.py", line 639, in open
    stream = PyAudio.Stream(self, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/pyaudio/__init__.py", line 441, in __init__
    self._stream = pa.open(**arguments)
                   ^^^^^^^^^^^^^^^^^^^^
OSError: [Errno -9997] Invalid sample rate
2024-10-19 00:36:55,951 - main - INFO - Initailizing SpookyPi...
2024-10-19 00:36:55,952 - main - INFO - Creating the manual log directory...
2024-10-19 00:36:55,952 - main - INFO - Creating the captures directory...
2024-10-19 00:36:55,952 - main - INFO - Initializing services...
2024-10-19 00:38:03,057 - main - INFO - Initailizing SpookyPi...
2024-10-19 00:38:03,057 - main - INFO - Creating the manual log directory...
2024-10-19 00:38:03,057 - main - INFO - Creating the captures directory...
2024-10-19 00:38:03,058 - main - INFO - Initializing services...
2024-10-19 00:40:02,928 - main - INFO - Initailizing SpookyPi...
2024-10-19 00:40:02,929 - main - INFO - Creating the manual log directory...
2024-10-19 00:40:02,929 - main - INFO - Creating the captures directory...
2024-10-19 00:40:02,929 - main - INFO - Initializing services...
2024-10-19 00:44:48,431 - main - INFO - Initailizing SpookyPi...
2024-10-19 00:44:48,432 - main - INFO - Creating the manual log directory...
2024-10-19 00:44:48,432 - main - INFO - Creating the captures directory...
2024-10-19 00:44:48,432 - main - INFO - Initializing services...
2024-10-19 00:44:48,875 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:80
 * Running on http://192.168.5.3:80
2024-10-19 00:44:48,875 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2024-10-19 00:44:48,877 - werkzeug - INFO -  * Restarting with stat
2024-10-19 00:44:51,878 - main - INFO - Initailizing SpookyPi...
2024-10-19 00:44:51,879 - main - INFO - Creating the manual log directory...
2024-10-19 00:44:51,879 - main - INFO - Creating the captures directory...
2024-10-19 00:44:51,879 - main - INFO - Initializing services...
2024-10-19 00:44:52,205 - werkzeug - WARNING -  * Debugger is active!
2024-10-19 00:44:52,206 - werkzeug - INFO -  * Debugger PIN: 106-189-788
2024-10-19 00:45:05,372 - werkzeug - INFO - 192.168.5.2 - - [19/Oct/2024 00:45:05] "GET / HTTP/1.1" 200 -
2024-10-19 00:45:07,002 - werkzeug - INFO - 192.168.5.2 - - [19/Oct/2024 00:45:07] "[32mPOST /start HTTP/1.1[0m" 302 -
2024-10-19 00:45:07,026 - werkzeug - INFO - 192.168.5.2 - - [19/Oct/2024 00:45:07] "GET / HTTP/1.1" 200 -
2024-10-19 00:45:18,973 - main - INFO - New object detected.
2024-10-19 00:45:18,989 - main - INFO - 2024-10-19_00-45-18 - Detected: person, Image: person_2024-10-19_00-45-18_0.jpg, Confidence: 0.99, ID: 0
2024-10-19 00:45:18,989 - OpenAIService - INFO - Using existing assistant
2024-10-19 00:46:32,663 - main - INFO - Initailizing SpookyPi...
2024-10-19 00:46:32,663 - main - INFO - Creating the manual log directory...
2024-10-19 00:46:32,664 - main - INFO - Creating the captures directory...
2024-10-19 00:46:32,664 - main - INFO - Initializing services...
2024-10-19 00:59:33,188 - main - INFO - Initailizing SpookyPi...
2024-10-19 00:59:33,188 - main - INFO - Creating the manual log directory...
2024-10-19 00:59:33,188 - main - INFO - Creating the captures directory...
2024-10-19 00:59:33,189 - main - INFO - Initializing services...
2024-10-19 00:59:33,567 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:80
 * Running on http://192.168.5.3:80
2024-10-19 00:59:33,567 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2024-10-19 00:59:33,568 - werkzeug - INFO -  * Restarting with stat
2024-10-19 00:59:36,567 - main - INFO - Initailizing SpookyPi...
2024-10-19 00:59:36,567 - main - INFO - Creating the manual log directory...
2024-10-19 00:59:36,568 - main - INFO - Creating the captures directory...
2024-10-19 00:59:36,568 - main - INFO - Initializing services...
2024-10-19 00:59:36,852 - werkzeug - WARNING -  * Debugger is active!
2024-10-19 00:59:36,853 - werkzeug - INFO -  * Debugger PIN: 106-189-788
2024-10-19 00:59:42,831 - werkzeug - INFO - 192.168.5.2 - - [19/Oct/2024 00:59:42] "GET / HTTP/1.1" 200 -
2024-10-19 00:59:44,317 - werkzeug - INFO - 192.168.5.2 - - [19/Oct/2024 00:59:44] "[32mPOST /start HTTP/1.1[0m" 302 -
2024-10-19 00:59:44,344 - werkzeug - INFO - 192.168.5.2 - - [19/Oct/2024 00:59:44] "GET / HTTP/1.1" 200 -
2024-10-19 00:59:55,246 - main - INFO - New object detected.
2024-10-19 00:59:55,249 - main - INFO - 2024-10-19_00-59-55 - Detected: person, Image: person_2024-10-19_00-59-55_0.jpg, Confidence: 0.95, ID: 0
2024-10-19 00:59:55,249 - OpenAIService - INFO - Using existing assistant
2024-10-19 01:00:04,182 - VoiceService - ERROR - Failed to generate audio: [Errno 32] Broken pipe
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 55, in generate_streaming_audio
    stream(audio_content)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/elevenlabs/play.py", line 91, in stream
    mpv_process.stdin.flush()  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^
BrokenPipeError: [Errno 32] Broken pipe
2024-10-19 01:00:04,293 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:04,297 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:04,389 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:04,391 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:04,484 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:04,486 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:04,581 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:04,583 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:04,682 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:04,683 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:04,779 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:04,780 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:04,875 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:04,876 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:04,972 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:04,974 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:05,069 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:05,070 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:05,160 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:05,162 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:05,255 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:05,256 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:05,350 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:05,351 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:05,446 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:05,448 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:05,543 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:05,544 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:05,641 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:05,642 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:05,738 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:05,739 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:05,836 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:05,837 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:05,934 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:05,936 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:06,031 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:06,033 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:06,129 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:06,131 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:06,225 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:06,226 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:06,320 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:06,322 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:06,416 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:06,418 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:06,510 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:06,512 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:06,610 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:06,611 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:06,703 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:06,704 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:06,797 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:06,799 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:06,890 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:06,892 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:06,985 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:06,986 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:07,082 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:07,083 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:07,173 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:07,175 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:07,266 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:07,267 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:07,357 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:07,359 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:07,452 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:07,453 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:07,548 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:07,549 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:07,646 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:07,648 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:07,746 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:07,747 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:07,841 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:07,843 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:07,936 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:07,938 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:08,032 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:08,034 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:08,127 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:08,129 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:08,225 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:08,226 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:08,319 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:08,321 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:08,416 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:08,418 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:08,516 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:08,518 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:08,624 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:08,626 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:08,721 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:08,723 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:08,816 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:08,818 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:08,911 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:08,912 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:09,006 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:09,008 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:09,102 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:09,103 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:09,197 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:09,198 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:09,291 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:09,293 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:09,387 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:09,388 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:09,481 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:09,482 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:09,580 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:09,582 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:09,676 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:09,677 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:09,773 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:09,775 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:09,869 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:09,871 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:09,963 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:09,965 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:10,057 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:10,058 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:10,155 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:10,157 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:10,248 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:10,249 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:10,344 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:10,346 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:10,442 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:10,444 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:10,540 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:10,542 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:10,640 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:10,641 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:10,735 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:10,737 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:10,840 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:10,841 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:10,938 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:10,940 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:11,034 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:11,035 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:11,131 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:11,133 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:11,225 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:11,227 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:11,321 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:11,323 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:11,416 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:11,417 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:11,515 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:11,517 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:11,617 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:11,618 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:11,715 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:11,716 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:11,807 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:11,809 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:11,902 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:11,904 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:11,994 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:11,996 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:12,089 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:12,090 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:12,183 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:12,185 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:12,276 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:12,277 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:12,368 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:12,370 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:12,466 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:12,467 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:12,555 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:12,557 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:12,647 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:12,649 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:12,739 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:12,740 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:12,833 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:12,834 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:12,927 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:12,929 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:13,023 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:13,024 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:13,117 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:13,119 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:13,213 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:13,214 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:13,307 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:13,309 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:13,404 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:13,405 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:13,498 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:13,499 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:13,597 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:13,599 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:13,706 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:13,707 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:13,801 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:13,802 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:13,896 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:13,898 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:13,990 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:13,992 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:14,086 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:14,087 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:14,182 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:14,184 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:14,277 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:14,278 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:14,373 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:14,375 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:14,470 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:14,471 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:14,567 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:14,569 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:14,663 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:14,666 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:14,759 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:14,761 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:14,855 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:14,857 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:14,946 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:14,948 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:15,038 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:15,040 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:15,136 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:15,138 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:15,233 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:15,235 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:15,331 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:15,334 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:15,429 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:15,431 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:15,523 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:15,525 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:15,621 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:15,622 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:15,721 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:15,722 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:15,824 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:15,826 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:15,919 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:15,920 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:16,014 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:16,015 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:16,110 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:16,111 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:16,204 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:16,205 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:16,298 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:16,300 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:16,393 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:16,394 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:16,486 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:16,488 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:16,578 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:16,580 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:16,676 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:16,678 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:16,771 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:16,773 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:16,865 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:16,866 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:16,958 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:16,959 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:17,051 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:17,052 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:17,146 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:17,148 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:17,242 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:17,243 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:17,335 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:17,337 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:17,433 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:17,434 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:17,534 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:17,535 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:17,629 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:17,631 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:17,726 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:17,728 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:17,822 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:17,824 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:17,921 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:17,923 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:18,016 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:18,018 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:18,111 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:18,113 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:18,206 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:18,208 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:18,299 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:18,301 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:18,397 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:18,399 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:18,494 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:18,495 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:18,592 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:18,594 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:18,694 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:18,696 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:18,803 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:18,805 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:18,902 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:18,903 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:18,996 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:18,998 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:19,091 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:19,093 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:19,187 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:19,189 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:19,283 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:19,285 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:19,379 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:19,381 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:19,473 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:19,474 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:19,567 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:19,568 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:19,665 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:19,666 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:19,760 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:19,761 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:19,855 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:19,856 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:19,956 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:19,958 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:20,054 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:20,055 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:20,151 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:20,152 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:20,246 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:20,248 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:20,340 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:20,344 - werkzeug - INFO - 192.168.5.2 - - [19/Oct/2024 01:00:20] "GET / HTTP/1.1" 200 -
2024-10-19 01:00:20,345 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:20,436 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:20,438 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:20,535 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:20,536 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:20,631 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:20,633 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:20,726 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:20,727 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:20,830 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:20,831 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:20,927 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:20,928 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:21,024 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:21,026 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:21,120 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:21,122 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:21,215 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:21,217 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:21,311 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:21,313 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:21,405 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:21,407 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:21,502 - VoiceService - ERROR - Failed to capture user response: 'NoneType' object has no attribute 'close'
Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 67, in listen_for_response_openai
    rec.adjust_for_ambient_noise(source)
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 383, in adjust_for_ambient_noise
    assert source.stream is not None, "Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Audio source must be entered before adjusting, see documentation for ``AudioSource``; are you using ``source`` outside of a ``with`` statement?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jonathanblackburn/repos/spookypi/app/ai_services/voice_service.py", line 66, in listen_for_response_openai
    with sr.Microphone(device_index=self.microphone_index) as source:
  File "/home/jonathanblackburn/repos/spookypi/venv-spookypi/lib/python3.11/site-packages/speech_recognition/__init__.py", line 189, in __exit__
    self.stream.close()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'close'
2024-10-19 01:00:21,504 - main - WARNING - Failed to capture user response.
2024-10-19 01:00:21,519 - werkzeug - INFO - 192.168.5.2 - - [19/Oct/2024 01:00:21] "[32mPOST /stop HTTP/1.1[0m" 302 -
2024-10-19 01:00:21,550 - werkzeug - INFO - 192.168.5.2 - - [19/Oct/2024 01:00:21] "GET / HTTP/1.1" 200 -
2024-10-19 01:13:15,704 - main - INFO - Initailizing SpookyPi...
2024-10-19 01:13:15,704 - main - INFO - Creating the manual log directory...
2024-10-19 01:13:15,704 - main - INFO - Creating the captures directory...
2024-10-19 01:13:15,704 - main - INFO - Initializing services...
2024-10-19 01:13:16,021 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:80
 * Running on http://192.168.5.3:80
2024-10-19 01:13:16,021 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2024-10-19 01:13:16,022 - werkzeug - INFO -  * Restarting with stat
2024-10-19 01:13:19,076 - main - INFO - Initailizing SpookyPi...
2024-10-19 01:13:19,076 - main - INFO - Creating the manual log directory...
2024-10-19 01:13:19,076 - main - INFO - Creating the captures directory...
2024-10-19 01:13:19,076 - main - INFO - Initializing services...
2024-10-19 01:13:19,447 - werkzeug - WARNING -  * Debugger is active!
2024-10-19 01:13:19,447 - werkzeug - INFO -  * Debugger PIN: 106-189-788
2024-10-19 01:13:27,028 - werkzeug - INFO - 192.168.5.2 - - [19/Oct/2024 01:13:27] "GET / HTTP/1.1" 200 -
2024-10-19 01:13:31,730 - werkzeug - INFO - 192.168.5.2 - - [19/Oct/2024 01:13:31] "[32mPOST /start HTTP/1.1[0m" 302 -
2024-10-19 01:13:31,759 - werkzeug - INFO - 192.168.5.2 - - [19/Oct/2024 01:13:31] "GET / HTTP/1.1" 200 -
2024-10-19 01:13:42,588 - main - INFO - New object detected.
2024-10-19 01:13:42,591 - main - INFO - 2024-10-19_01-13-42 - Detected: person, Image: person_2024-10-19_01-13-42_0.jpg, Confidence: 0.98, ID: 0
2024-10-19 01:13:42,591 - OpenAIService - INFO - Using existing assistant
2024-10-19 01:13:51,825 - VoiceService - INFO - Listening for user response at 1729314831.8254783...
2024-10-19 01:15:06,442 - werkzeug - INFO - 192.168.5.2 - - [19/Oct/2024 01:15:06] "GET / HTTP/1.1" 200 -
2024-10-19 01:15:20,024 - werkzeug - INFO - 192.168.5.2 - - [19/Oct/2024 01:15:20] "GET / HTTP/1.1" 200 -
